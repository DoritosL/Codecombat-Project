{"version":3,"sources":["app/collections/Prepaids.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,iBAAiB,QAAQ,4BAAR;;AACjB,UAAU,QAAQ,gBAAR;;AAEV,MAAM,SAAC,OAAD;SAAa,CAAC,CAAC,MAAF,CAAS,OAAT,EAAkB,SAAC,CAAD,EAAI,CAAJ;WAAU,IAAI;EAAd,CAAlB;AAAb;;AAEN,MAAM,CAAC,OAAP,GAAuB;;;;;;;qBACrB,QAAO;;qBAEP,MAAK;;qBAEL,aAAY;WACV,0CAAM,SAAN;EADU;;qBAGZ,aAAY,SAAC,OAAD;WACV,CACK,OAAO,CAAC,GAAR,CAAY,MAAZ,MAAuB,QAA1B,GAAwC,GAAxC,GAAiD,GADnD,EAEE,OAAO,CAAC,GAAR,CAAY,SAAZ,CAFF,CAGC,CAAC,QAHF;EADU;;qBAMZ,oBAAmB;AACjB;WAAA;;AAAK;AAAA;WAAA;;qBAAA,OAAO,CAAC,GAAR,CAAY,cAAZ;AAAA;;iBAAL,KAA6D;EAD5C;;qBAGnB,iBAAgB;AACd;WAAA;;AAAK;AAAA;WAAA;;qBAAA,CAAC,CAAC,IAAF,CAAO,OAAO,CAAC,GAAR,CAAY,WAAZ,CAAP;AAAA;;iBAAL,KAAkE;EADpD;;qBAGhB,iBAAgB;WAAG,IAAI,CAAC,GAAL,CAAS,IAAC,kBAAD,KAAuB,IAAC,eAAD,EAAhC,EAAmD,CAAnD;EAAH;;qBAEhB,iBAAgB,SAAC,SAAD,EAAY,IAAZ;;MACd,OAAQ;;;MACR,IAAI,CAAC,OAAQ;;IACb,IAAI,CAAC,IAAI,CAAC,OAAV,GAAoB;WACpB,IAAC,MAAD,CAAO,IAAP;EAJc;;;;GAtBsB","file":"public/javascripts/app/collections/Prepaids.js","sourcesContent":["CocoCollection = require 'collections/CocoCollection'\nPrepaid = require 'models/Prepaid'\n\nsum = (numbers) -> _.reduce(numbers, (a, b) -> a + b)\n\nmodule.exports = class Prepaids extends CocoCollection\n  model: Prepaid\n\n  url: \"/db/prepaid\"\n  \n  initialize: ->\n    super(arguments...)\n\n  comparator: (prepaid) ->\n    [\n      if prepaid.get('type') is 'course' then 'C' else 'S'\n      prepaid.get('endDate')\n    ].toString()\n\n  totalMaxRedeemers: ->\n    sum((prepaid.get('maxRedeemers') for prepaid in @models)) or 0\n    \n  totalRedeemers: ->\n    sum((_.size(prepaid.get('redeemers')) for prepaid in @models)) or 0\n    \n  totalAvailable: -> Math.max(@totalMaxRedeemers() - @totalRedeemers(), 0)\n\n  fetchByCreator: (creatorID, opts) ->\n    opts ?= {}\n    opts.data ?= {}\n    opts.data.creator = creatorID\n    @fetch opts\n"]}