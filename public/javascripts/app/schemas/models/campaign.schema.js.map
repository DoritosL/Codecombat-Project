{"version":3,"sources":["app/schemas/models/campaign.schema.coffee"],"names":[],"mappings":";AAAA;;AAAA,IAAI,QAAQ,cAAR;;AACJ,cAAc,QAAQ,SAAR;;AAEd,iBAAiB,CAAC,CAAC,MAAF,CACf;EAAA,WACE;IAAA,MAAM,MAAN;GADF;CADe;;AAGjB,CAAC,CAAC,qBAAF,CAAwB,cAAxB;;AAEA,CAAC,CAAC,MAAF,CAAS,cAAc,CAAC,UAAxB,EAAoC;EAClC,MAAM;IAAC,MAAM,QAAP;IAAiB,OAAO,MAAxB;IAAgC,QAAQ,MAAxC;IAAgD,OAAO,CAAC,MAAD,EAAS,UAAT,EAAqB,aAArB,CAAvD;GAD4B;EAElC,UAAU;IAAE,MAAM,QAAR;IAAkB,OAAO,WAAzB;IAAsC,aAAa,yBAAnD;GAFwB;EAGlC,aAAa;IAAE,MAAM,QAAR;IAAkB,QAAQ,QAA1B;IAAoC,aAAa,2CAAjD;GAHqB;EAIlC,MAAM,CAAC,CAAC,WAAF,CAAc;IAAA,OAAO,MAAP;IAAe,aAAa,gCAA5B;IAA8D,QAAQ,CAAC,MAAD,EAAS,QAAT,EAAkB,QAAlB,CAAtE;GAAd,CAJ4B;EAMlC,cAAc,CAAC,CAAC,MAAF,CAAS,EAAT,EACZ;IAAA,KAAK;MAAE,MAAM,QAAR;MAAkB,QAAQ,YAA1B;KAAL;IACA,KAAK;MAAE,MAAM,QAAR;MAAkB,QAAQ,YAA1B;KADL;GADY,CANoB;EAUlC,iBAAiB,CAAC,CAAC,KAAF,CAAQ,EAAR,EAAY;IAC3B,MAAM,QADqB;IAE3B,sBAAsB,KAFK;IAG3B,YAAY;MACV,OAAO;QAAE,MAAM,QAAR;QAAkB,QAAQ,YAA1B;OADG;MAEV,OAAO;QAAE,MAAM,QAAR;OAFG;KAHe;GAAZ,CAViB;EAkBlC,iBAAiB;IAAE,MAAM,QAAR;GAlBiB;EAmBlC,4BAA4B;IAAE,MAAM,QAAR;GAnBM;EAqBlC,mBAAmB;IAAE,MAAM,QAAR;IAAkB,QAAQ,WAA1B;IAAuC,sBAAsB;MAC9E,OAAO,UADuE;MAE9E,MAAM,QAFwE;MAG9E,QAAQ,UAHsE;MAI9E,YAAY;QAEV,IAAI;UAAE,MAAM,QAAR;UAAkB,QAAQ,QAA1B;SAFM;QAGV,MAAM;UAAE,MAAM,QAAR;UAAkB,QAAQ,QAA1B;SAHI;QAIV,aAAa;UAAE,MAAM,QAAR;UAAkB,QAAQ,QAA1B;SAJH;QAKV,MAAM;UAAE,MAAM,QAAR;UAAkB,QAAQ,QAA1B;SALI;QAMV,MAAM;UAAE,MAAM,QAAR;UAAkB,QAAQ,QAA1B;SANI;QASV,UAAU,CAAC,CAAC,OAAF,EATA;QAUV,UAAU;UAAE,MAAM,QAAR;UAAkB,QAAQ,SAA1B;SAVA;QAWV,OAAO;UAAE,MAAM,QAAR;SAXG;QAYV,gBACE;UAAA,OAAO;YACL;cAAE,MAAM,QAAR;cAAkB,OAAO;gBAAC;kBAAC,KAAK,IAAN;kBAAY,MAAM,yBAAlB;iBAAD;eAAzB;cAAyE,QAAQ,mCAAjF;aADK,EAEL;cACE,MAAM,OADR;cAEE,OAAO;gBAAE,MAAM,QAAR;gBAAkB,OAAO;kBAAC;oBAAC,KAAK,IAAN;oBAAY,MAAM,yBAAlB;mBAAD;iBAAzB;gBAAyE,QAAQ,mCAAjF;eAFT;aAFK;WAAP;SAbQ;OAJkE;KAA7D;GArBe;EA+ClC,eAAe,CAAC,CAAC,IAAF,EA/CmB;EAiDlC,QAAQ;IAAE,MAAM,QAAR;IAAkB,QAAQ,QAA1B;IAAoC,sBAAsB;MAChE,OAAO,OADyD;MAEhE,MAAM,QAF0D;MAGhE,QAAQ,OAHwD;MAIhE,sBAAsB,KAJ0C;MAOhE,YAAY;QAEV,SAAS;UAAE,QAAQ,SAAV;UAAqB,MAAM,OAA3B;UAAoC,OAAO;YAClD,MAAM,QAD4C;YAElD,sBAAsB,KAF4B;YAGlD,YACE;cAAA,aAAa;gBAAE,MAAM,QAAR;gBAAkB,OAAO;kBAAC;oBAAC,KAAK,IAAN;oBAAY,MAAM,uBAAlB;mBAAD;iBAAzB;gBAAuE,QAAQ,aAA/E;eAAb;cACA,MAAM;gBAAE,MAAM,QAAR;gBAAkB,OAAO;kBAAC;oBAAC,KAAK,IAAN;oBAAY,MAAM,8BAAlB;mBAAD;iBAAzB;gBAA8E,QAAQ,mCAAtF;eADN;cAEA,MAAM;gBAAE,MAAM,QAAR;gBAAkB,OAAO;kBAAC;oBAAC,KAAK,IAAN;oBAAY,MAAM,8BAAlB;mBAAD;iBAAzB;gBAA8E,QAAQ,mCAAtF;eAFN;cAGA,OAAO;gBAAE,MAAM,QAAR;gBAAkB,OAAO;kBAAC;oBAAC,KAAK,IAAN;oBAAY,MAAM,yBAAlB;mBAAD;iBAAzB;gBAAyE,QAAQ,mCAAjF;eAHP;cAIA,MAAM;gBAAE,QAAM,CAAC,QAAD,EAAW,OAAX,EAAoB,QAApB,CAAR;eAJN;aAJgD;WAA3C;SAFC;QAcV,UAAU,CAAC,CAAC,OAAF,EAdA;OAPoD;KAA1D;GAjD0B;CAApC;;AA8EA,cAAc,CAAC,2BAAf,GAA6C,CAC3C,MAD2C,EAE3C,aAF2C,EAG3C,MAH2C,EAI3C,sBAJ2C,EAK3C,YAL2C,EAM3C,MAN2C,EAO3C,MAP2C,EAQ3C,MAR2C,EAS3C,UAT2C,EAU3C,YAV2C,EAW3C,UAX2C,EAY3C,0BAZ2C,EAa3C,gBAb2C,EAc3C,WAd2C,EAe3C,WAf2C,EAgB3C,eAhB2C,EAiB3C,qBAjB2C,EAkB3C,iBAlB2C,EAmB3C,kBAnB2C,EAoB3C,UApB2C,EAqB3C,UArB2C,EAsB3C,kBAtB2C,EAuB3C,uBAvB2C,EAwB3C,mBAxB2C,EAyB3C,iBAzB2C,EA0B3C,sBA1B2C,EA2B3C,qBA3B2C,EA4B3C,wBA5B2C,EA6B3C,cA7B2C,EA8B3C,gBA9B2C,EA+B3C,oBA/B2C,EAgC3C,sBAhC2C,EAiC3C,mBAjC2C,EAkC3C,UAlC2C,EAmC3C,iBAnC2C,EAoC3C,gBApC2C,EAqC3C,UArC2C,EAsC3C,eAtC2C,EAuC3C,YAvC2C;;AAyC7C,wBAAwB,CAAC,MAAD,EAAS,aAAT,EAAwB,MAAxB,EAAgC,YAAhC,EAA8C,MAA9C,EAAsD,UAAtD,EAAkE,gBAAlE,EAAoF,WAApF,EAAiG,UAAjG,EAA6G,YAA7G;;AACxB;AAAA;;EACE,cAAc,CAAC,UAAU,CAAC,MAAM,CAAC,oBAAoB,CAAC,UAAW,MAAjE,GAAyE,CAAC,CAAC,SAAF,CAAY,WAAW,CAAC,UAAW,MAAnC;AAD3E;;AAEA;;EACE,cAAc,CAAC,UAAU,CAAC,MAAM,CAAC,oBAAoB,CAAC,UAAW,YAAW,CAAC,MAA7E,GAAsF;AADxF;;AAGA,CAAC,CAAC,qBAAF,CAAwB,cAAxB,EAAwC,UAAxC;;AACA,CAAC,CAAC,mCAAF,CAAsC,cAAtC;;AACA,CAAC,CAAC,yBAAF,CAA4B,cAA5B;;AAEA,MAAM,CAAC,OAAP,GAAiB","file":"public/javascripts/app/schemas/models/campaign.schema.js","sourcesContent":["c = require './../schemas'\nLevelSchema = require './level'\n\nCampaignSchema = c.object\n  default:\n    type: 'hero'\nc.extendNamedProperties CampaignSchema  # name first\n\n_.extend CampaignSchema.properties, {\n  i18n: {type: 'object', title: 'i18n', format: 'i18n', props: ['name', 'fullName', 'description']}\n  fullName: { type: 'string', title: 'Full Name', description: 'Ex.: \"Kithgard Dungeon\"' }\n  description: { type: 'string', format: 'string', description: 'How long it takes and what players learn.' }\n  type: c.shortString(title: 'Type', description: 'What kind of campaign this is.', 'enum': ['hero', 'course','hidden'])\n\n  ambientSound: c.object {},\n    mp3: { type: 'string', format: 'sound-file' }\n    ogg: { type: 'string', format: 'sound-file' }\n\n  backgroundImage: c.array {}, {\n    type: 'object'\n    additionalProperties: false\n    properties: {\n      image: { type: 'string', format: 'image-file' }\n      width: { type: 'number' }\n    }\n  }\n  backgroundColor: { type: 'string' }\n  backgroundColorTransparent: { type: 'string' }\n\n  adjacentCampaigns: { type: 'object', format: 'campaigns', additionalProperties: {\n    title: 'Campaign'\n    type: 'object'\n    format: 'campaign'\n    properties: {\n      #- denormalized from other Campaigns, either updated automatically or fetched dynamically\n      id: { type: 'string', format: 'hidden' }\n      name: { type: 'string', format: 'hidden' }\n      description: { type: 'string', format: 'hidden' }\n      i18n: { type: 'object', format: 'hidden' }\n      slug: { type: 'string', format: 'hidden' }\n\n      #- normal properties\n      position: c.point2d()\n      rotation: { type: 'number', format: 'degrees' }\n      color: { type: 'string' }\n      showIfUnlocked:\n        oneOf: [\n          { type: 'string', links: [{rel: 'db', href: '/db/level/{($)}/version'}], format: 'latest-version-original-reference' }\n          {\n            type: 'array',\n            items: { type: 'string', links: [{rel: 'db', href: '/db/level/{($)}/version'}], format: 'latest-version-original-reference' }\n          }\n        ]\n    }\n  }}\n  levelsUpdated: c.date()\n\n  levels: { type: 'object', format: 'levels', additionalProperties: {\n    title: 'Level'\n    type: 'object'\n    format: 'level'\n    additionalProperties: false\n\n    # key is the original property\n    properties: {\n      #- denormalized from Achievements\n      rewards: { format: 'rewards', type: 'array', items: {\n        type: 'object'\n        additionalProperties: false\n        properties:\n          achievement: { type: 'string', links: [{rel: 'db', href: '/db/achievement/{{$}}'}], format: 'achievement' }\n          item: { type: 'string', links: [{rel: 'db', href: '/db/thang.type/{($)}/version'}], format: 'latest-version-original-reference' }\n          hero: { type: 'string', links: [{rel: 'db', href: '/db/thang.type/{($)}/version'}], format: 'latest-version-original-reference' }\n          level: { type: 'string', links: [{rel: 'db', href: '/db/level/{($)}/version'}], format: 'latest-version-original-reference' }\n          type: { enum: ['heroes', 'items', 'levels'] }\n      }}\n\n      #- normal properties\n      position: c.point2d()\n\n      #- denormalized properties from Levels are cloned below\n    }\n\n  }}\n}\n\nCampaignSchema.denormalizedLevelProperties = [\n  'name'\n  'description'\n  'i18n'\n  'requiresSubscription'\n  'replayable'\n  'type'\n  'kind'\n  'slug'\n  'original'\n  'adventurer'\n  'practice'\n  'practiceThresholdMinutes'\n  'primerLanguage'\n  'shareable'\n  'adminOnly'\n  'disableSpaces'\n  'hidesSubmitUntilRun'\n  'hidesPlayButton'\n  'hidesRunShortcut'\n  'hidesHUD'\n  'hidesSay'\n  'hidesCodeToolbar'\n  'hidesRealTimePlayback'\n  'backspaceThrottle'\n  'lockDefaultCode'\n  'moveRightLoopSnippet'\n  'realTimeSpeedFactor'\n  'autocompleteFontSizePx'\n  'requiredGear'\n  'restrictedGear'\n  'requiredProperties'\n  'restrictedProperties'\n  'recommendedHealth'\n  'concepts'\n  'primaryConcepts'\n  'picoCTFProblem'\n  'campaign'\n  'campaignIndex'\n  'scoreTypes'\n]\nhiddenLevelProperties = ['name', 'description', 'i18n', 'replayable', 'slug', 'original', 'primerLanguage', 'shareable', 'concepts', 'scoreTypes']\nfor prop in CampaignSchema.denormalizedLevelProperties\n  CampaignSchema.properties.levels.additionalProperties.properties[prop] = _.cloneDeep(LevelSchema.properties[prop])\nfor hiddenProp in hiddenLevelProperties\n  CampaignSchema.properties.levels.additionalProperties.properties[hiddenProp].format = 'hidden'\n\nc.extendBasicProperties CampaignSchema, 'campaign'\nc.extendTranslationCoverageProperties CampaignSchema\nc.extendPatchableProperties CampaignSchema\n\nmodule.exports = CampaignSchema\n"]}