{"version":3,"sources":["app/lib/world/system.coffee"],"names":[],"mappings":";AAIA;EAAA;;AAAA,MAAM,CAAC,OAAP,GAAuB;EACrB,MAAC,UAAD,GAAY;;EACC,gBAAC,KAAD,EAAS,MAAT;AAGX;IAHY,IAAC,SAAD;AAGZ;AAAA;;MACE,IAAE,KAAF,GAAS;AADX;IAEA,IAAC,WAAD,GAAc;IACd,IAAC,OAAD,GAAU;EANC;;mBASb,QAAO,SAAC,MAAD;;mBAIP,SAAQ,SAAC,MAAD;AACN;WAAA,OAAO;EADD;;mBAIR,SAAQ,SAAC,MAAD;;mBAER,cAAa,SAAC,SAAD;AACX;IAAA,WAAW;IACX,IAAC,WAAU,CAAC,IAAZ,CAAiB,CAAC,QAAD,EAAW,SAAX,CAAjB;WACA;EAHW;;mBAMb,WAAU,SAAC,KAAD;AACR;AAAA;AAAA;qBAAK,oBAAU;MACb,IAAG,UAAU,KAAV,CAAH;QACE,IAAG,aAAa,QAAb,YAAH;UACE,QAAQ,CAAC,IAAT,CAAc,KAAd,EADF;SADF;OAAA;QAIE,aAAa,QAAQ,CAAC,OAAT,CAAiB,KAAjB;QACb,IAAG,eAAgB,CAAC,CAApB;UACE,QAAQ,CAAC,MAAT,CAAgB,UAAhB,EAA4B,CAA5B,EADF;SALF;;AADF;WAQA;EATQ;;mBAYV,oBAAmB,SAAC,KAAD,EAAQ,QAAR;;mBAEnB,aAAY,SAAC,CAAD;AACV;IAAA,IAAqB,KAAK,IAAC,OAA3B;AAAA,aAAO,IAAC,OAAO,IAAf;;IACA,OAAO;AACP,SAAS,gGAAT;MACE,OAAO,OAAO,EAAP,GAAY,CAAC,CAAC,UAAF,CAAa,CAAb;AADrB;IAEA,OAAO,IAAC,OAAO,GAAR,GAAa,OAAO;WAC3B;EANU;;mBAQZ,WAAU;WACR,cAAY,IAAC,YAAW,CAAC;EADjB","file":"public/javascripts/app/lib/world/system.js","sourcesContent":["# The System will operate on its Thangs of interest in each WorldFrame.\n# Systems so far: AI, UI, Collision, Movement, Targeting, Programming, Combat, Vision, Hearing, Inventory, Actions\n# Other Systems might be things like Attraction, EdgeBounce, EdgeWrap, and non-physics ones, too, like Rendering, Animation, ...\n\nmodule.exports = class System\n  @className: 'System'\n  constructor: (@world, config) ->\n    # Unlike with Component, we don't automatically copy all our properties onto the World.\n    # Subclasses can copy select properties here if they like.\n    for key, value of (config ? {})\n      @[key] = value\n    @registries = []\n    @hashes = {}\n\n  # Start is called once the beginning, after all Thangs have been loaded.\n  start: (thangs) ->\n\n  # Update is called once per frame on all thangs that currently have exist=true in the World.\n  # We return a simple numeric hash that will combine to a frame hash help us determine whether this frame has changed later on.\n  update: (thangs) ->\n    hash = 0\n\n  # Finish is called once at the end, after all frames have been generated.\n  finish: (thangs) ->\n\n  addRegistry: (condition) ->\n    registry = []\n    @registries.push [registry, condition]\n    registry\n\n  # Register is called whenever a Thang changes important state (exists, dead, etc), and can be called more specifically by individual Thangs.\n  register: (thang) ->\n    for [registry, condition] in @registries\n      if condition thang\n        if thang not in registry\n          registry.push thang\n      else\n        thangIndex = registry.indexOf thang\n        if thangIndex isnt -1\n          registry.splice thangIndex, 1\n    null\n\n  # Override this to determine which registries have which conditions\n  checkRegistration: (thang, registry) ->\n\n  hashString: (s) ->\n    return @hashes[s] if s of @hashes\n    hash = 0\n    for i in [0 ... Math.min(s.length, 100)]\n      hash = hash * 31 + s.charCodeAt(i)\n    hash = @hashes[s] = hash % 3.141592653589793\n    hash\n\n  toString: ->\n    \"<System: #{@constructor.className}\"\n"]}