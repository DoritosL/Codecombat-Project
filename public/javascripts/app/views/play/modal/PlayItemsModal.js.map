{"version":3,"sources":["app/templates/play/modal/play-items-modal.jade","app/views/play/modal/PlayItemsModal.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"public/javascripts/app/views/play/modal/PlayItemsModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),gems = locals_.gems,itemCategories = locals_.itemCategories,itemCategoryNames = locals_.itemCategoryNames,itemCategoryCollections = locals_.itemCategoryCollections,me = locals_.me;buf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><img src=\\\"/images/pages/play/modal/items-background.png\\\" draggable=\\\"false\\\" id=\\\"play-items-modal-bg\\\"/><img src=\\\"/images/pages/play/modal/items-background-narrow.png\\\" draggable=\\\"false\\\" id=\\\"play-items-modal-narrow-bg\\\"/><h1 data-i18n=\\\"play.items\\\" class=\\\"big-font\\\"></h1><div id=\\\"gems-count-container\\\"><span id=\\\"gems-count\\\" class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = gems) ? \"\" : jade.interp)) + \"</span></div><div id=\\\"close-modal\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span></div><ul class=\\\"nav nav-pills nav-stacked\\\">\");\n// iterate itemCategories\n;(function(){\n  var $$obj = itemCategories;\n  if ('number' == typeof $$obj.length) {\n\n    for (var index = 0, $$l = $$obj.length; index < $$l; index++) {\n      var category = $$obj[index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(category + '-tab'), \"class\": [(index ? \"\" : \"active\")] }, {\"class\":true,\"id\":true})) + \"><a\" + (jade.attrs({ 'href':(\"#item-category-\" + category), 'data-toggle':(\"tab\"), \"class\": [('one-line')] }, {\"href\":true,\"data-toggle\":true})) + \"><img\" + (jade.attrs({ 'src':(\"/images/pages/play/modal/item-icon-\"+category+\".png\"), 'draggable':(\"false\"), \"class\": [('tab-icon')] }, {\"src\":true,\"draggable\":true})) + \"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = itemCategoryNames[index]) ? \"\" : jade.interp)) + \"</span></a></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var index in $$obj) {\n      $$l++;      var category = $$obj[index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(category + '-tab'), \"class\": [(index ? \"\" : \"active\")] }, {\"class\":true,\"id\":true})) + \"><a\" + (jade.attrs({ 'href':(\"#item-category-\" + category), 'data-toggle':(\"tab\"), \"class\": [('one-line')] }, {\"href\":true,\"data-toggle\":true})) + \"><img\" + (jade.attrs({ 'src':(\"/images/pages/play/modal/item-icon-\"+category+\".png\"), 'draggable':(\"false\"), \"class\": [('tab-icon')] }, {\"src\":true,\"draggable\":true})) + \"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = itemCategoryNames[index]) ? \"\" : jade.interp)) + \"</span></a></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul><div id=\\\"hero-type-select\\\" data-toggle=\\\"buttons\\\" class=\\\"btn-group\\\"><label id=\\\"all\\\" class=\\\"btn active\\\"><input type=\\\"radio\\\" name=\\\"hero-class-select\\\" autocomplete=\\\"off\\\"/><span data-i18n=\\\"editor.level_tab_thangs_all\\\"></span></label><label id=\\\"warrior\\\" class=\\\"btn\\\"><input type=\\\"radio\\\" name=\\\"hero-class-select\\\" autocomplete=\\\"off\\\"/><span data-i18n=\\\"general.warrior\\\"></span></label><label id=\\\"ranger\\\" class=\\\"btn\\\"><input type=\\\"radio\\\" name=\\\"hero-class-select\\\" autocomplete=\\\"off\\\"/><span data-i18n=\\\"general.ranger\\\"></span></label><label id=\\\"wizard\\\" class=\\\"btn\\\"><input type=\\\"radio\\\" name=\\\"hero-class-select\\\" autocomplete=\\\"off\\\"/><span data-i18n=\\\"general.wizard\\\"></span></label></div><div class=\\\"tab-content\\\">\");\n// iterate itemCategories\n;(function(){\n  var $$obj = itemCategories;\n  if ('number' == typeof $$obj.length) {\n\n    for (var index = 0, $$l = $$obj.length; index < $$l; index++) {\n      var category = $$obj[index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"item-category-\" + category), \"class\": [('tab-pane'),(index ? \"\" : \"active\")] }, {\"class\":true,\"id\":true})) + \"><div class=\\\"nano\\\"><div class=\\\"nano-content\\\">\");\n// iterate itemCategoryCollections[category].models\n;(function(){\n  var $$obj = itemCategoryCollections[category].models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var item = $$obj[$index];\n\nvar hidden = item.comingSoon && !me.isAdmin()\nhidden = hidden || (!item.get('gems') && !item.owned)\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-id':(item.id), \"class\": [(\"item \" + item.get('heroClass') + (hidden ? \" hide\" : \"\") + (item.silhouetted && !item.owned ? \" silhouetted\" : \"\"))] }, {\"class\":true,\"data-item-id\":true})) + \">\");\nif ( item.silhouetted && !item.owned)\n{\nbuf.push(\"<span class=\\\"glyphicon glyphicon-lock bolder\\\"></span><span class=\\\"glyphicon glyphicon-lock\\\"></span><img draggable=\\\"false\\\" class=\\\"item-silhouette\\\"/>\");\nif ( item.level)\n{\nbuf.push(\"<div class=\\\"required-level\\\"><div data-i18n=\\\"general.player_level\\\"></div><div>\" + (jade.escape(null == (jade.interp = item.level) ? \"\" : jade.interp)) + \"</div></div>\");\n}\n}\nelse\n{\nbuf.push(\"<strong class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.name) ? \"\" : jade.interp)) + \"</strong><img draggable=\\\"false\\\" class=\\\"item-img\\\"/>\");\n}\nif ( item.owned)\n{\nbuf.push(\"<span data-i18n=\\\"play.owned\\\" class=\\\"big-font owned\\\"></span>\");\n}\nelse if ( item.silhouetted)\n{\nbuf.push(\"<span data-i18n=\\\"play.locked\\\" class=\\\"big-font locked\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span class=\\\"cost\\\"><img src=\\\"/images/common/gem.png\\\" draggable=\\\"false\\\"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.get('gems')) ? \"\" : jade.interp)) + \"</span></span>\");\nif ( item.unequippable)\n{\nbuf.push(\"<span class=\\\"big-font unequippable\\\">\" + (jade.escape(null == (jade.interp = item.get('heroClass')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"play.unlock\"), 'data-item-id':(item.id), \"class\": [('btn'),('unlock-button'),('big-font')] }, {\"data-i18n\":true,\"data-item-id\":true})) + \"></button>\");\n}\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var item = $$obj[$index];\n\nvar hidden = item.comingSoon && !me.isAdmin()\nhidden = hidden || (!item.get('gems') && !item.owned)\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-id':(item.id), \"class\": [(\"item \" + item.get('heroClass') + (hidden ? \" hide\" : \"\") + (item.silhouetted && !item.owned ? \" silhouetted\" : \"\"))] }, {\"class\":true,\"data-item-id\":true})) + \">\");\nif ( item.silhouetted && !item.owned)\n{\nbuf.push(\"<span class=\\\"glyphicon glyphicon-lock bolder\\\"></span><span class=\\\"glyphicon glyphicon-lock\\\"></span><img draggable=\\\"false\\\" class=\\\"item-silhouette\\\"/>\");\nif ( item.level)\n{\nbuf.push(\"<div class=\\\"required-level\\\"><div data-i18n=\\\"general.player_level\\\"></div><div>\" + (jade.escape(null == (jade.interp = item.level) ? \"\" : jade.interp)) + \"</div></div>\");\n}\n}\nelse\n{\nbuf.push(\"<strong class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.name) ? \"\" : jade.interp)) + \"</strong><img draggable=\\\"false\\\" class=\\\"item-img\\\"/>\");\n}\nif ( item.owned)\n{\nbuf.push(\"<span data-i18n=\\\"play.owned\\\" class=\\\"big-font owned\\\"></span>\");\n}\nelse if ( item.silhouetted)\n{\nbuf.push(\"<span data-i18n=\\\"play.locked\\\" class=\\\"big-font locked\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span class=\\\"cost\\\"><img src=\\\"/images/common/gem.png\\\" draggable=\\\"false\\\"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.get('gems')) ? \"\" : jade.interp)) + \"</span></span>\");\nif ( item.unequippable)\n{\nbuf.push(\"<span class=\\\"big-font unequippable\\\">\" + (jade.escape(null == (jade.interp = item.get('heroClass')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"play.unlock\"), 'data-item-id':(item.id), \"class\": [('btn'),('unlock-button'),('big-font')] }, {\"data-i18n\":true,\"data-item-id\":true})) + \"></button>\");\n}\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"clearfix\\\"></div></div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var index in $$obj) {\n      $$l++;      var category = $$obj[index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"item-category-\" + category), \"class\": [('tab-pane'),(index ? \"\" : \"active\")] }, {\"class\":true,\"id\":true})) + \"><div class=\\\"nano\\\"><div class=\\\"nano-content\\\">\");\n// iterate itemCategoryCollections[category].models\n;(function(){\n  var $$obj = itemCategoryCollections[category].models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var item = $$obj[$index];\n\nvar hidden = item.comingSoon && !me.isAdmin()\nhidden = hidden || (!item.get('gems') && !item.owned)\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-id':(item.id), \"class\": [(\"item \" + item.get('heroClass') + (hidden ? \" hide\" : \"\") + (item.silhouetted && !item.owned ? \" silhouetted\" : \"\"))] }, {\"class\":true,\"data-item-id\":true})) + \">\");\nif ( item.silhouetted && !item.owned)\n{\nbuf.push(\"<span class=\\\"glyphicon glyphicon-lock bolder\\\"></span><span class=\\\"glyphicon glyphicon-lock\\\"></span><img draggable=\\\"false\\\" class=\\\"item-silhouette\\\"/>\");\nif ( item.level)\n{\nbuf.push(\"<div class=\\\"required-level\\\"><div data-i18n=\\\"general.player_level\\\"></div><div>\" + (jade.escape(null == (jade.interp = item.level) ? \"\" : jade.interp)) + \"</div></div>\");\n}\n}\nelse\n{\nbuf.push(\"<strong class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.name) ? \"\" : jade.interp)) + \"</strong><img draggable=\\\"false\\\" class=\\\"item-img\\\"/>\");\n}\nif ( item.owned)\n{\nbuf.push(\"<span data-i18n=\\\"play.owned\\\" class=\\\"big-font owned\\\"></span>\");\n}\nelse if ( item.silhouetted)\n{\nbuf.push(\"<span data-i18n=\\\"play.locked\\\" class=\\\"big-font locked\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span class=\\\"cost\\\"><img src=\\\"/images/common/gem.png\\\" draggable=\\\"false\\\"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.get('gems')) ? \"\" : jade.interp)) + \"</span></span>\");\nif ( item.unequippable)\n{\nbuf.push(\"<span class=\\\"big-font unequippable\\\">\" + (jade.escape(null == (jade.interp = item.get('heroClass')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"play.unlock\"), 'data-item-id':(item.id), \"class\": [('btn'),('unlock-button'),('big-font')] }, {\"data-i18n\":true,\"data-item-id\":true})) + \"></button>\");\n}\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var item = $$obj[$index];\n\nvar hidden = item.comingSoon && !me.isAdmin()\nhidden = hidden || (!item.get('gems') && !item.owned)\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-id':(item.id), \"class\": [(\"item \" + item.get('heroClass') + (hidden ? \" hide\" : \"\") + (item.silhouetted && !item.owned ? \" silhouetted\" : \"\"))] }, {\"class\":true,\"data-item-id\":true})) + \">\");\nif ( item.silhouetted && !item.owned)\n{\nbuf.push(\"<span class=\\\"glyphicon glyphicon-lock bolder\\\"></span><span class=\\\"glyphicon glyphicon-lock\\\"></span><img draggable=\\\"false\\\" class=\\\"item-silhouette\\\"/>\");\nif ( item.level)\n{\nbuf.push(\"<div class=\\\"required-level\\\"><div data-i18n=\\\"general.player_level\\\"></div><div>\" + (jade.escape(null == (jade.interp = item.level) ? \"\" : jade.interp)) + \"</div></div>\");\n}\n}\nelse\n{\nbuf.push(\"<strong class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.name) ? \"\" : jade.interp)) + \"</strong><img draggable=\\\"false\\\" class=\\\"item-img\\\"/>\");\n}\nif ( item.owned)\n{\nbuf.push(\"<span data-i18n=\\\"play.owned\\\" class=\\\"big-font owned\\\"></span>\");\n}\nelse if ( item.silhouetted)\n{\nbuf.push(\"<span data-i18n=\\\"play.locked\\\" class=\\\"big-font locked\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span class=\\\"cost\\\"><img src=\\\"/images/common/gem.png\\\" draggable=\\\"false\\\"/><span class=\\\"big-font\\\">\" + (jade.escape(null == (jade.interp = item.get('gems')) ? \"\" : jade.interp)) + \"</span></span>\");\nif ( item.unequippable)\n{\nbuf.push(\"<span class=\\\"big-font unequippable\\\">\" + (jade.escape(null == (jade.interp = item.get('heroClass')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"play.unlock\"), 'data-item-id':(item.id), \"class\": [('btn'),('unlock-button'),('big-font')] }, {\"data-i18n\":true,\"data-item-id\":true})) + \"></button>\");\n}\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"clearfix\\\"></div></div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div><div id=\\\"item-details-view\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\ntemplate = require 'templates/play/modal/play-items-modal'\nbuyGemsPromptTemplate = require 'templates/play/modal/buy-gems-prompt'\nItemDetailsView = require './ItemDetailsView'\nBuyGemsModal = require 'views/play/modal/BuyGemsModal'\nCreateAccountModal = require 'views/core/CreateAccountModal'\n\nCocoCollection = require 'collections/CocoCollection'\nThangType = require 'models/ThangType'\nLevelComponent = require 'models/LevelComponent'\nLevel = require 'models/Level'\nPurchase = require 'models/Purchase'\n\nutils = require 'core/utils'\n\nPAGE_SIZE = 200\n\nslotToCategory = {\n  'right-hand': 'primary'\n\n  'left-hand': 'secondary'\n\n  'head': 'armor'\n  'torso': 'armor'\n  'gloves': 'armor'\n  'feet': 'armor'\n\n  'eyes': 'accessories'\n  'neck': 'accessories'\n  'wrists': 'accessories'\n  'left-ring': 'accessories'\n  'right-ring': 'accessories'\n  'waist': 'accessories'\n\n  'pet': 'misc'\n  'minion': 'misc'\n  'flag': 'misc'\n  'misc-0': 'misc'\n  'misc-1': 'misc'\n\n  'programming-book': 'books'\n}\n\nmodule.exports = class PlayItemsModal extends ModalView\n  className: 'modal fade play-modal'\n  template: template\n  id: 'play-items-modal'\n\n  events:\n    'click .item': 'onItemClicked'\n    'shown.bs.tab': 'onTabClicked'\n    'click .unlock-button': 'onUnlockButtonClicked'\n    'click .buy-gems-prompt-button': 'onBuyGemsPromptButtonClicked'\n    'click #close-modal': 'hide'\n    'click': 'onClickedSomewhere'\n    'update .tab-pane .nano': 'showVisibleItemImages'\n    'click #hero-type-select label': 'onClickHeroTypeSelect'\n\n  constructor: (options) ->\n    @showVisibleItemImages = _.throttle(_.bind(@showVisibleItemImages, @), 200)\n    super options\n    @items = new Backbone.Collection()\n    @itemCategoryCollections = {}\n\n    project = [\n      'name'\n      'components.config'\n      'components.original'\n      'slug'\n      'original'\n      'rasterIcon'\n      'gems'\n      'tier'\n      'description'\n      'i18n'\n      'heroClass'\n    ]\n\n    itemFetcher = new CocoCollection([], { url: '/db/thang.type?view=items', project: project, model: ThangType })\n    itemFetcher.skip = 0\n    itemFetcher.fetch({data: {skip: 0, limit: PAGE_SIZE}})\n    @listenTo itemFetcher, 'sync', @onItemsFetched\n    @stopListening @supermodel, 'loaded-all'\n    @supermodel.loadCollection(itemFetcher, 'items')\n    @idToItem = {}\n\n  onItemsFetched: (itemFetcher) ->\n    gemsOwned = me.gems()\n    needMore = itemFetcher.models.length is PAGE_SIZE\n    for model in itemFetcher.models\n      model.owned = me.ownsItem model.get('original')\n      continue unless (cost = model.get('gems')) or model.owned\n      category = slotToCategory[model.getAllowedSlots()[0]] or 'misc'\n      @itemCategoryCollections[category] ?= new Backbone.Collection()\n      collection = @itemCategoryCollections[category]\n      collection.comparator = (m) -> m.get('tier') ? m.get('gems')\n      collection.add(model)\n      model.name = utils.i18n model.attributes, 'name'\n      model.affordable = cost <= gemsOwned\n      model.silhouetted = not model.owned and model.isSilhouettedItem()\n      model.level = model.levelRequiredForItem() if model.get('tier')?\n      model.unequippable = not _.intersection(me.getHeroClasses(), model.getAllowedHeroClasses()).length\n      model.comingSoon = not model.getFrontFacingStats().props.length and not _.size(model.getFrontFacingStats().stats) and not model.owned  # Temp: while there are placeholder items\n      @idToItem[model.id] = model\n\n    if itemFetcher.skip isnt 0\n      # Make sure we render the newly fetched items, except the first time (when it happens automatically).\n      @render()\n\n    if needMore\n      itemFetcher.skip += PAGE_SIZE\n      itemFetcher.fetch({data: {skip: itemFetcher.skip, limit: PAGE_SIZE}})\n\n  getRenderData: (context={}) ->\n    context = super(context)\n    context.itemCategoryCollections = @itemCategoryCollections\n    context.itemCategories = _.keys @itemCategoryCollections\n    context.itemCategoryNames = ($.i18n.t \"items.#{category}\" for category in context.itemCategories)\n    context.gems = me.gems()\n    context\n\n  afterRender: ->\n    super()\n    return unless @supermodel.finished()\n    @playSound 'game-menu-open'\n    @$el.find('.nano:visible').nanoScroller({alwaysVisible: true})\n    @itemDetailsView = new ItemDetailsView()\n    @insertSubView(@itemDetailsView)\n    @$el.find(\"a[href='#item-category-armor']\").click()  # Start on armor tab, if it's there.\n    earnedLevels = me.get('earned')?.levels or []\n    if Level.levels['defense-of-plainswood'] not in earnedLevels\n      @$el.find('#misc-tab').hide()\n      @$el.find('#hero-type-select #warrior').click()  # Start on warrior tab, if low level.\n    @showVisibleItemImages()\n\n  onHidden: ->\n    super()\n    @playSound 'game-menu-close'\n\n\n  #- Click events\n\n  onItemClicked: (e) ->\n    return if $(e.target).closest('.unlock-button').length\n    @playSound 'menu-button-click'\n    itemEl = $(e.target).closest('.item')\n    wasSelected = itemEl.hasClass('selected')\n    @$el.find('.item.selected').removeClass('selected')\n    if wasSelected\n      item = null\n    else\n      item = @idToItem[itemEl.data('item-id')]\n      if item.silhouetted and not item.owned\n        item = null\n      else\n        itemEl.addClass('selected') unless wasSelected\n    @itemDetailsView.setItem(item)\n\n  onTabClicked: (e) ->\n    @playSound 'game-menu-tab-switch'\n    nano = $($(e.target).attr('href')).find('.nano')\n    nano.nanoScroller({alwaysVisible: true})\n    @paneNanoContent = nano.find('.nano-content')\n    @showVisibleItemImages()\n\n  showVisibleItemImages: ->\n    # dynamically load visible items when the user scrolls enough to see them\n    return console.error \"Couldn't update scroll, since paneNanoContent wasn't initialized.\" unless @paneNanoContent\n    items = @paneNanoContent.find('.item:not(.loaded)')\n    threshold = @paneNanoContent.height() + 100\n    for itemEl in items\n      itemEl = $(itemEl)\n      if itemEl.position().top < threshold\n        $(itemEl).addClass('loaded')\n        item = @idToItem[itemEl.data('item-id')]\n        itemEl.find('.item-silhouette, .item-img').attr('src', item.getPortraitURL())\n\n  onClickHeroTypeSelect: (e) ->\n    value = $(e.target).closest('label').attr('id')\n    tabContent = @$el.find('.tab-content')\n    tabContent.removeClass('filter-wizard filter-ranger filter-warrior')\n    tabContent.addClass(\"filter-#{value}\") if value isnt 'all'\n\n  onUnlockButtonClicked: (e) ->\n    e.stopPropagation()\n    button = $(e.target).closest('button')\n    item = @idToItem[button.data('item-id')]\n    gemsOwned = me.gems()\n    cost = item.get('gems') ? 0\n    affordable = cost <= gemsOwned\n    if not affordable\n      @playSound 'menu-button-click'\n      @askToBuyGems button unless features.freeOnly\n    else if button.hasClass('confirm')\n      @playSound 'menu-button-unlock-end'\n      purchase = Purchase.makeFor(item)\n      purchase.save()\n\n      #- set local changes to mimic what should happen on the server...\n      purchased = me.get('purchased') ? {}\n      purchased.items ?= []\n      purchased.items.push(item.get('original'))\n      item.owned = true\n      me.set('purchased', purchased)\n      me.set('spent', (me.get('spent') ? 0) + item.get('gems'))\n\n      #- ...then rerender key bits\n      @renderSelectors(\".item[data-item-id='#{item.id}']\", \"#gems-count\")\n      console.log('render selectors', \".item[data-item-id='#{item.id}']\", \"#gems-count\")\n      @itemDetailsView.render()\n      @showVisibleItemImages()\n\n      Backbone.Mediator.publish 'store:item-purchased', item: item, itemSlug: item.get('slug')\n    else\n      @playSound 'menu-button-unlock-start'\n      button.addClass('confirm').text($.i18n.t('play.confirm'))\n      @$el.one 'click', (e) ->\n        button.removeClass('confirm').text($.i18n.t('play.unlock')) if e.target isnt button[0]\n\n  askToSignUp: ->\n    createAccountModal = new CreateAccountModal supermodel: @supermodel\n    return @openModalView createAccountModal\n\n  askToBuyGems: (unlockButton) ->\n    @$el.find('.unlock-button').popover 'destroy'\n    popoverTemplate = buyGemsPromptTemplate {}\n    unlockButton.popover(\n      animation: true\n      trigger: 'manual'\n      placement: 'top'\n      content: ' '  # template has it\n      container: @$el\n      template: popoverTemplate\n    ).popover 'show'\n    popover = unlockButton.data('bs.popover')\n    popover?.$tip?.i18n()\n\n  onBuyGemsPromptButtonClicked: (e) ->\n    @playSound 'menu-button-click'\n    return @askToSignUp() if me.get('anonymous')\n    @openModalView new BuyGemsModal()\n\n  onClickedSomewhere: (e) ->\n    return if @destroyed\n    @$el.find('.unlock-button').popover 'destroy'\n\n  destroy: ->\n    @$el.find('.unlock-button').popover 'destroy'\n    super()\n"]}