{"version":3,"sources":["app/views/admin/FilesView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,uBAAR;;AACX,gBAAgB,QAAQ,6BAAR;;AAEhB,MAAM,CAAC,OAAP,GAAuB;;;;;;;;;;sBACrB,KAAI;;sBACJ,WAAU;;sBAEV,SACE;IAAA,wBAAwB;aAAG,UAAU,CAAC,IAAX,CAAgB;QAAC,WAAU,SAAX;OAAhB,EAAuC,IAAC,aAAxC;IAAH,CAAxB;IACA,yBAAyB,WADzB;;;sBAGF,cAAa;IACX;IACA,QAAQ,0BAAR;WACA,IAAC,UAAD;EAHW;;sBAKb,eAAc,SAAC,OAAD;AACZ;IAAA,OACE;MAAA,KAAK,OAAO,CAAC,GAAb;MACA,UAAU,OAAO,CAAC,QADlB;MAEA,UAAU,OAAO,CAAC,QAFlB;MAGA,MAAM,IAAC,cAAD,EAHN;MAIA,OAAO,IAJP;;IAQF,IAAC,cAAD,GAAiB,CAAC,IAAC,cAAD,EAAD,EAAmB,OAAO,CAAC,QAA3B,CAAoC,CAAC,IAArC,CAA0C,GAA1C;WACjB,CAAC,CAAC,IAAF,CAAO,OAAP,EAAgB;MAAC,MAAM,MAAP;MAAe,MAAM,IAArB;MAA2B,SAAS,IAAC,eAArC;KAAhB;EAXY;;sBAad,iBAAgB,SAAC,CAAD;WACd,IAAC,UAAD;EADc;;sBAGhB,gBAAe;WAAG,IAAC,IAAG,CAAC,IAAL,CAAU,gBAAV,CAA2B,CAAC,GAA5B;EAAH;;sBAEf,YAAW;WACT,CAAC,CAAC,IAAF,CACE;MAAA,KAAK,WAAQ,CAAC,IAAC,cAAD,EAAD,CAAR,GAA0B,GAA/B;MACA,SAAS,IAAC,cADV;MAEA,OAAO,KAFP;KADF;EADS;;sBAMX,gBAAe,SAAC,GAAD;AACb;IAAA,QAAQ,cAAc;MAAC,OAAM,GAAP;KAAd;WACR,IAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,WAAzB,CAAqC,KAArC;EAFa;;;;GArCwB","file":"public/javascripts/app/views/admin/FilesView.js","sourcesContent":["RootView = require 'views/core/RootView'\ntemplate = require 'templates/admin/files'\ntableTemplate = require 'templates/admin/files_table'\n\nmodule.exports = class FilesView extends RootView\n  id: 'admin-files-view'\n  template: template\n\n  events:\n    'click #upload-button': -> filepicker.pick {mimetypes:'audio/*'}, @onFileChosen\n    'change #folder-select': 'loadFiles'\n\n  afterRender: ->\n    super()\n    require('core/services/filepicker')()  # Initialize if needed\n    @loadFiles()\n\n  onFileChosen: (InkBlob) =>\n    body =\n      url: InkBlob.url\n      filename: InkBlob.filename\n      mimetype: InkBlob.mimetype\n      path: @currentFolder()\n      force: true\n\n    # Automatically overwrite if the same path was put in here before\n#    body.force = true # if InkBlob.filename is @data\n    @uploadingPath = [@currentFolder(), InkBlob.filename].join('/')\n    $.ajax('/file', {type: 'POST', data: body, success: @onFileUploaded})\n\n  onFileUploaded: (e) =>\n    @loadFiles()\n\n  currentFolder: -> @$el.find('#folder-select').val()\n\n  loadFiles: ->\n    $.ajax\n      url: \"/file/#{@currentFolder()}/\"\n      success: @onLoadedFiles\n      cache: false\n\n  onLoadedFiles: (res) =>\n    table = tableTemplate({files:res})\n    @$el.find('#file-table').replaceWith(table)\n"]}