{"version":3,"sources":["app/views/admin/UserCodeProblemsView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,oCAAR;;AACX,kBAAkB,QAAQ,wBAAR;;AAElB,MAAM,CAAC,OAAP,GAAuB;;;iCAGrB,KAAI;;iCACJ,WAAU;;EAEG,8BAAC,OAAD;IACX,sDAAM,OAAN;IACA,IAAC,aAAD,GAAgB;IAChB,IAAC,oBAAD;EAHW;;iCAKb,sBAAqB;AAOnB;IAAA,YAAgB;IAChB,IAAG,SAAS,CAAC,QAAV,OAAwB,CAA3B;MACE,SAAS,CAAC,QAAV,CAAmB,EAAnB;MACA,SAAS,CAAC,OAAV,CAAkB,SAAS,CAAC,OAAV,KAAsB,CAAxC,EAFF;KAAA;MAIE,SAAS,CAAC,QAAV,CAAmB,SAAS,CAAC,QAAV,KAAuB,CAA1C,EAJF;;IAMA,aAAa,CACX,CAAC,OAAD,EAAU,GAAV,CADW,EAEX,CAAC,MAAD,EAAS,UAAT,CAFW,EAGX,CAAC,OAAD,EAAU,SAAV,CAHW,EAIX,CAAC,KAAD,EAAQ,SAAS,CAAC,QAAV,EAAR,CAJW;IAMb,aAAa,CAAC,CAAC,KAAF,CAAQ;MAAC,YAAW,IAAI,CAAC,SAAL,CAAe,UAAf,CAAZ;KAAR;IACb,4BAA4B,QAAQ,CAAC,UAAU,CAAC,MAApB,CAA2B;MACrD,OAAO,eAD8C;MAErD,KAAK,2BAA2B,UAFqB;KAA3B;IAI5B,IAAC,iBAAD,GAAwB;IACxB,IAAC,iBAAgB,CAAC,KAAlB;WACA,IAAC,SAAD,CAAU,IAAC,iBAAX,EAA6B,KAA7B,EAAoC;MAClC,IAAC,aAAD,GAAgB;aAChB,IAAC,OAAD;IAFkC,CAApC;EA3BmB;;iCA+BrB,gBAAe;AACb;IAAA,IAAI;IACJ,CAAC,CAAC,YAAF,GAAiB,IAAC;IAClB,CAAC,CAAC,gBAAF;;AAAsB;AAAA;WAAA;;qBAAA,OAAO,CAAC;AAAR;;;WACtB;EAJa;;;;GA1CmC","file":"public/javascripts/app/views/admin/UserCodeProblemsView.js","sourcesContent":["RootView = require 'views/core/RootView'\ntemplate = require 'templates/admin/user-code-problems'\nUserCodeProblem = require 'models/UserCodeProblem'\n\nmodule.exports = class UserCodeProblemsView extends RootView\n  # TODO: Pagination, choosing filters on the page itself.\n\n  id: 'admin-user-code-problems-view'\n  template: template\n\n  constructor: (options) ->\n    super options\n    @fetchingData = true\n    @getUserCodeProblems()\n\n  getUserCodeProblems: ->\n    # can have this page show arbitrary conditions, see mongoose queries\n    # http://mongoosejs.com/docs/queries.html\n    # Each list in conditions is a function call.\n    # The first arg is the function name\n    # The rest are the args for the function\n\n    lastMonth = new Date()\n    if lastMonth.getMonth() is 1\n      lastMonth.setMonth 12\n      lastMonth.setYear lastMonth.getYear() - 1\n    else\n      lastMonth.setMonth lastMonth.getMonth() - 1\n\n    conditions = [\n      ['limit', 300]\n      ['sort', '-created']\n      ['where', 'created']\n      ['gte', lastMonth.toString()]\n    ]\n    conditions = $.param({conditions:JSON.stringify(conditions)})\n    UserCodeProblemCollection = Backbone.Collection.extend({\n      model: UserCodeProblem\n      url: '/db/user.code.problem?' + conditions\n    })\n    @userCodeProblems = new UserCodeProblemCollection()\n    @userCodeProblems.fetch()\n    @listenTo @userCodeProblems, 'all', ->\n      @fetchingData = false\n      @render()\n\n  getRenderData: ->\n    c = super()\n    c.fetchingData = @fetchingData\n    c.userCodeProblems = (problem.attributes for problem in @userCodeProblems.models)\n    c\n"]}