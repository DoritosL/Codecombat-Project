{"version":3,"sources":["app/views/editor/level/systems/NewLevelSystemModal.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,WAAW,QAAQ,mCAAR;;AACX,cAAc,QAAQ,oBAAR;;AACd,QAAQ,QAAQ,YAAR;;AACP,KAAM,QAAQ,WAAR,EAAN;;AAED,MAAM,CAAC,OAAP,GAAuB;;;;;;;gCACrB,KAAI;;gCACJ,WAAU;;gCACV,UAAS;;gCACT,oBAAmB;;gCAEnB,SACE;IAAA,kCAAkC,oBAAlC;IACA,eAAe,oBADf;;;gCAGF,qBAAoB,SAAC,CAAD;AAClB;IAAA,CAAC,CAAC,cAAF;IACA,SAAS,IAAC,IAAG,CAAC,IAAL,CAAU,sBAAV,CAAiC,CAAC,GAAlC;IACT,OAAO,IAAC,IAAG,CAAC,IAAL,CAAU,oBAAV,CAA+B,CAAC,GAAhC;IACP,SAAa;IACb,MAAM,CAAC,GAAP,CAAW,MAAX,EAAmB,IAAnB;IACA,MAAM,CAAC,GAAP,CAAW,MAAX,EAAmB,MAAM,CAAC,GAAP,CAAW,MAAX,EAAmB,IAAnB,CAAwB,CAAC,OAAzB,CAAiC,SAAjC,EAA4C,IAA5C,CAAnB;IACA,MAAM,CAAC,GAAP,CAAW,aAAX,EAA0B;MAAC;QAAC,QAAQ,OAAT;QAAkB,QAAQ,EAAE,CAAC,EAA7B;OAAD;KAA1B;IACA,MAAM,MAAM,CAAC,IAAP,CAAY,IAAZ,EAAkB;MAAC,MAAM,MAAP;KAAlB;IACN,KAAc,GAAd;AAAA;;IAEA,IAAC,YAAD;IACA,GAAG,CAAC,KAAJ,CAAU;aAAA;QACR,KAAC,YAAD;QACA,OAAO,CAAC,GAAR,CAAY,aAAZ,EAA2B,IAAI,CAAC,KAAL,CAAW,GAAG,CAAC,YAAf,CAA3B;eACA,KAAK,CAAC,iBAAN,CAAwB,KAAC,IAAzB,EAA8B,IAAI,CAAC,KAAL,CAAW,GAAG,CAAC,YAAf,CAA9B;MAHQ;IAAA,QAAV;WAIA,GAAG,CAAC,OAAJ,CAAY;aAAA;QACV,KAAC,WAAU,CAAC,aAAZ,CAA0B,MAA1B;QACA,QAAQ,CAAC,QAAQ,CAAC,OAAlB,CAA0B,0BAA1B,EAAsD;UAAA,UAAU,MAAM,CAAC,GAAP,CAAW,KAAX,CAAV;UAA6B,cAAc,CAA3C;SAAtD;eACA,KAAC,KAAD;MAHU;IAAA,QAAZ;EAhBkB;;;;GAV6B","file":"public/javascripts/app/views/editor/level/systems/NewLevelSystemModal.js","sourcesContent":["ModalView = require 'views/core/ModalView'\ntemplate = require 'templates/editor/level/system/new'\nLevelSystem = require 'models/LevelSystem'\nforms = require 'core/forms'\n{me} = require 'core/auth'\n\nmodule.exports = class NewLevelSystemModal extends ModalView\n  id: 'editor-level-system-new-modal'\n  template: template\n  instant: false\n  modalWidthPercent: 60\n\n  events:\n    'click #new-level-system-submit': 'makeNewLevelSystem'\n    'submit form': 'makeNewLevelSystem'\n\n  makeNewLevelSystem: (e) ->\n    e.preventDefault()\n    system = @$el.find('#level-system-system').val()\n    name = @$el.find('#level-system-name').val()\n    system = new LevelSystem()\n    system.set 'name', name\n    system.set 'code', system.get('code', true).replace(/Jitter/g, name)\n    system.set 'permissions', [{access: 'owner', target: me.id}]  # Private until saved in a published Level\n    res = system.save(null, {type: 'POST'})  # Override PUT so we can trigger postFirstVersion logic\n    return unless res\n\n    @showLoading()\n    res.error =>\n      @hideLoading()\n      console.log 'Got errors:', JSON.parse(res.responseText)\n      forms.applyErrorsToForm(@$el, JSON.parse(res.responseText))\n    res.success =>\n      @supermodel.registerModel system\n      Backbone.Mediator.publish 'editor:edit-level-system', original: system.get('_id'), majorVersion: 0\n      @hide()\n"]}