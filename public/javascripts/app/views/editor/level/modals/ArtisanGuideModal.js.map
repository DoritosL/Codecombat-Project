{"version":3,"sources":["app/views/editor/level/modals/ArtisanGuideModal.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,WAAW,QAAQ,kDAAR;;AAEX,QAAQ,QAAQ,YAAR;;AACP,qBAAsB,QAAQ,cAAR,EAAtB;;AAED,gBACE;EAAA,sBAAsB,KAAtB;EACA,UAAU,CAAC,YAAD,EAAe,cAAf,EAA+B,kBAA/B,EAAmD,eAAnD,CADV;EAEA,YACE;IAAA,YACE;MAAA,MAAM,QAAN;KADF;IAEA,cACE;MAAA,MAAM,QAAN;KAHF;IAIA,kBACE;MAAA,MAAM,QAAN;KALF;IAMA,eACE;MAAA,MAAM,QAAN;KAPF;GAHF;;;AAYF,MAAM,CAAC,OAAP,GAAuB;;;;;;;8BACrB,KAAI;;8BACJ,WAAU;;8BACV,SACE;IAAA,uBAAuB,aAAvB;;;8BAEF,aAAY,SAAC,OAAD;IACV,IAAC,MAAD,GAAS,OAAO,CAAC;WACjB,IAAC,QAAD,GACE;MAAA,OAAM,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAAN;MACA,WAAU,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CADV;;EAHQ;;8BAMZ,cAAa;AACX;IAAA,IAAC,UAAD,CAAW,mBAAX;IACA,KAAK,CAAC,eAAN,CAAsB,IAAC,IAAvB;IACA,UAAU,KAAK,CAAC,YAAN,CAAmB,IAAC,IAApB;IACV,MAAM,GAAG,CAAC,gBAAJ,CAAqB,OAArB,EAA8B,aAA9B;IACN,KAAuD,GAAG,CAAC,KAA3D;AAAA,aAAO,KAAK,CAAC,iBAAN,CAAwB,IAAC,IAAzB,EAA8B,GAAG,CAAC,MAAlC,EAAP;;IACA,iBAAiB;MAAC,SAAQ,gBAAgB,OAAO,CAAC,UAAxB,GAAmC,wDAAnC,GAC6B,IAAC,QAAO,CAAC,SADtC,GACgD,KADhD,GACoD,IAAC,QAAO,CAAC,KAD7D,GACmE,iBADnE,GAEb,OAAO,CAAC,YAFK,GAEQ,iBAFR,GAGT,OAAO,CAAC,gBAHC,GAGgB,cAHhB,GAIZ,OAAO,CAAC,aAJL;;IAKjB,IAAC,oBAAD,CAAqB,cAArB;IACA,iBAAiB,CAAC,CAAC,KAAF,CAAQ,cAAR,EAAwB,IAAC,QAAzB;IACjB,cAAc,CAAC,OAAf,GAAyB,EAAE,CAAC,GAAH,CAAO,SAAP;IACzB,mBAAmB,cAAnB,EAAmC,IAAC,IAApC;WACA,CAAC,CAAC,IAAF,CAAO,cAAY,EAAE,CAAC,EAAf,GAAkB,2BAAzB;EAfW;;8BAiBb,sBAAqB,SAAC,OAAD;AACnB;IAAA,IAAG,CAAC,CAAC,OAAL;MACE,OAAO,CAAC,OAAR,GAAqB,CAAC,CAAC,OAAO,CAAC,QAAX,GAAoB,GAApB,GAAuB,CAAC,CAAC,OAAO,CAAC,IAAjC,GAAsC,GAAtC,GAAyC,CAAC,CAAC,OAAO,CAAC,cADzE;;IAEA,OAAO,CAAC,UAAR,GAAuB,kGAAiB,EAAE,MAAF,CAAS,CAAC,KAAV,EAAjB,IAAmC,KAAnC,GAAuC,qGAAkB,EAAE,MAAF,CAAS,CAAC,MAAV,EAAlB;WAC9D,OAAO,CAAC,aAAR,GAAwB,IAAC;EAJN;;8BAMrB,eAAc;IACZ,IAAG,IAAC,MAAK,CAAC,QAAP,OAAqB,EAAE,CAAC,EAA3B;AACE,aAAO,KADT;;AAEA,WAAO;EAHK;;;;GAnCiC","file":"public/javascripts/app/views/editor/level/modals/ArtisanGuideModal.js","sourcesContent":["ModalView = require 'views/core/ModalView'\ntemplate = require 'templates/editor/level/modal/artisan-guide-modal'\n\nforms = require 'core/forms'\n{sendContactMessage} = require 'core/contact'\n\ncontactSchema =\n  additionalProperties: false\n  required: ['creditName', 'levelPurpose', 'levelInspiration', 'levelLocation']\n  properties:\n    creditName:\n      type: 'string'\n    levelPurpose:\n      type: 'string'\n    levelInspiration:\n      type: 'string'\n    levelLocation:\n      type: 'string'\n\nmodule.exports = class ArtisanGuideModal extends ModalView\n  id: 'artisan-guide-modal'\n  template: template\n  events:\n    'click #level-submit': 'levelSubmit'\n\n  initialize: (options) ->\n    @level = options.level\n    @options = \n      level:@level.get('name')\n      levelSlug:@level.get('slug')\n\n  levelSubmit: ->\n    @playSound 'menu-button-click'\n    forms.clearFormAlerts @$el\n    results = forms.formToObject @$el\n    res = tv4.validateMultiple results, contactSchema\n    return forms.applyErrorsToForm @$el, res.errors unless res.valid\n    contactMessage = {message:\"\"\"User Name: #{results.creditName}\n      Level: <a href=\"http://codecombat.com/editor/level/#{@options.levelSlug}\">#{@options.level}</a>\n      Purpose: #{results.levelPurpose}\n      Inspiration: #{results.levelInspiration}\n      Location: #{results.levelLocation}\"\"\"}\n    @populateBrowserData contactMessage\n    contactMessage = _.merge contactMessage, @options\n    contactMessage.country = me.get('country')\n    sendContactMessage contactMessage, @$el\n    $.post \"/db/user/#{me.id}/track/contact_codecombat\"\n\n  populateBrowserData: (context) ->\n    if $.browser\n      context.browser = \"#{$.browser.platform} #{$.browser.name} #{$.browser.versionNumber}\"\n    context.screenSize = \"#{screen?.width ? $(window).width()} x #{screen?.height ? $(window).height()}\"\n    context.screenshotURL = @screenshotURL\n\n  hasOwnership: ->\n    if @level.getOwner() is me.id\n      return true\n    return false"]}