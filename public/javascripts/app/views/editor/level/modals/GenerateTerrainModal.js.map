{"version":3,"sources":["app/views/editor/level/modals/GenerateTerrainModal.coffee"],"names":[],"mappings":"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","file":"public/javascripts/app/views/editor/level/modals/GenerateTerrainModal.js","sourcesContent":["ModalView = require 'views/core/ModalView'\ntemplate = require 'templates/editor/level/modal/generate-terrain-modal'\nCocoModel = require 'models/CocoModel'\n\nclusters = {\n  'hero': {\n    'thangs': ['Hero Placeholder']\n    'margin': 1\n  }\n  'rocks': {\n    'thangs': ['Rock 1', 'Rock 2', 'Rock 3', 'Rock 4', 'Rock 5', 'Rock Cluster 1', 'Rock Cluster 2', 'Rock Cluster 3']\n    'margin': 1\n  }\n  'trees': {\n    'thangs': ['Tree 1', 'Tree 2', 'Tree 3', 'Tree 4']\n    'margin': 0.5\n    }\n  'tree_stands': {\n    'thangs': ['Tree Stand 1', 'Tree Stand 2', 'Tree Stand 3', 'Tree Stand 4', 'Tree Stand 5', 'Tree Stand 6']\n    'margin': 3\n  }\n  'shrubs': {\n    'thangs': ['Shrub 1', 'Shrub 2', 'Shrub 3']\n    'margin': 0.5\n    }\n  'houses': {\n    'thangs': ['House 1', 'House 2', 'House 3', 'House 4']\n    'margin': 4\n    }\n  'animals': {\n    'thangs': ['Cow', 'Horse']\n    'margin': 1\n    }\n  'wood': {\n    'thangs': ['Firewood 1', 'Firewood 2', 'Firewood 3']\n    'margin': 1\n    }\n  'farm': {\n    'thangs': ['Farm']\n    'margin': 9\n    }\n  'cave': {\n    'thangs': ['Cave']\n    'margin': 5\n    }\n  'stone': {\n    'thangs': ['Gargoyle', 'Rock Cluster 1', 'Rock Cluster 2', 'Rock Cluster 3']\n    'margin': 1\n    }\n  'torch': {\n    'thangs': ['Torch']\n    'margin': 0\n  }\n  'chains': {\n    'thangs': ['Chains']\n    'margin': 0\n  }\n  'barrel': {\n    'thangs': ['Barrel']\n    'margin': 1\n  }\n  'doors': {\n    'thangs': ['Dungeon Door']\n    'margin': -1\n    }\n  'grass_floor': {\n    'thangs': ['Grass01', 'Grass02', 'Grass03', 'Grass04', 'Grass05']\n    'margin': -1\n    }\n  'dungeon_wall': {\n    'thangs': ['Dungeon Wall']\n    'margin': 2\n    }\n  'dungeon_floor': {\n    'thangs': ['Dungeon Floor']\n    'margin': -1\n    }\n  'indoor_wall': {\n    'thangs': ['Indoor Wall']\n    'margin': 2\n    }\n  'indoor_floor': {\n    'thangs': ['Indoor Floor']\n    'margin': -1\n    }\n  'furniture': {\n    'thangs': ['Bookshelf', 'Chair', 'Table', 'Candle', 'Treasure Chest']\n    'margin': -1\n    }\n  'desert_walls': {\n    'thangs': ['Desert Wall 1', 'Desert Wall 2', 'Desert Wall 3', 'Desert Wall 4', 'Desert Wall 5', 'Desert Wall 6', 'Desert Wall 7', 'Desert Wall 8']\n    'margin': 6\n  }\n  'desert_floor': {\n    'thangs': ['Sand 01', 'Sand 02', 'Sand 03', 'Sand 04', 'Sand 05', 'Sand 06']\n    'margin': -1\n  }\n  'oases': {\n    'thangs': ['Oasis 1', 'Oasis 2', 'Oasis 3']\n    'margin': 4\n  }\n  'mountain_floor': {\n    'thangs': ['Talus 1', 'Talus 2', 'Talus 3', 'Talus 4', 'Talus 5', 'Talus 6']\n    'margin': -1\n  }\n  'mountain_walls': {\n    'thangs': ['Mountain 1','Mountain 3']\n    'margin': 6\n  }\n  'glacier_floor': {\n    'thangs': ['Firn 1', 'Firn 2', 'Firn 3', 'Firn 4', 'Firn 5', 'Firn 6']\n    'margin': -1\n  }\n  'glacier_walls': {\n    'thangs': ['Ice Wall']\n    'margin': 2\n  }\n}\n\npresets = {\n  'dungeon': {\n    'terrainName': 'Dungeon'\n    'type':'dungeon'\n    'borders':'dungeon_wall'\n    'borderNoise':0\n    'borderSize':4\n    'borderThickness':1\n    'floors':'dungeon_floor'\n    'decorations': {\n      'Room': {\n        'num': [1,1]\n        'width': [12, 20]\n        'height': [8, 16]\n        'thickness': [2,2]\n        'cluster': 'dungeon_wall'\n      }\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n      'Barrels': {\n        'num': [1,1]\n        'width': [8, 12]\n        'height': [8, 12]\n        'numBarrels': [4,6]\n        'cluster': 'barrel'\n      }\n      'cave': {\n        'num':[1,1]\n        'width': 10\n        'height': 10\n        'clusters': {\n          'cave':[1,1]\n          'stone':[2,4]\n        }\n      }\n    }\n  }\n  'indoor': {\n    'terrainName': 'Indoor'\n    'type':'indoor'\n    'borders':'indoor_wall'\n    'borderNoise':0\n    'borderSize':4\n    'borderThickness':1\n    'floors':'indoor_floor'\n    'decorations': {\n      'Room': {\n        'num': [1,1]\n        'width': [12, 20]\n        'height': [8, 16]\n        'thickness': [2,2]\n        'cluster': 'indoor_wall'\n      }\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n      'furniture': {\n        'num':[1,2]\n        'width': 15\n        'height': 15\n        'clusters': {\n          'furniture':[2,4]\n        }\n      }\n    }\n  }\n  'grassy': {\n    'terrainName': 'Grass'\n    'type':'grassy'\n    'borders':'tree_stands'\n    'borderNoise':1\n    'borderSize':2\n    'borderThickness':2\n    'floors':'grass_floor'\n    'decorations': {\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n      'house': {\n        'num':[1,2] #min-max\n        'width': 15\n        'height': 15\n        'clusters': {\n          'houses':[1,1]\n          'trees':[1,2]\n          'shrubs':[0,3]\n          'rocks':[1,2]\n        }\n      }\n      'farm': {\n        'num':[1,1] #min-max\n        'width': 25\n        'height': 15\n        'clusters': {\n          'farm':[1,1]\n          'shrubs':[2,3]\n          'wood':[2,4]\n          'animals':[2,3]\n        }\n      }\n    }\n  }\n  'desert': {\n    'terrainName': 'Desert'\n    'type':'desert'\n    'borders':'desert_walls'\n    'borderNoise':2\n    'borderSize':4\n    'borderThickness':4\n    'floors':'desert_floor'\n    'decorations': {\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n      'oasis': {\n        'num':[1,2] #min-max\n        'width': 10\n        'height': 10\n        'clusters': {\n          'oases':[1,1]\n          'shrubs':[0,5]\n          'rocks':[0,2]\n        }\n      }\n    }\n  },\n  'mountain': {\n    'terrainName': 'Mountain'\n    'type': 'mountain'\n    'floors': 'mountain_floor'\n    'borders': 'mountain_walls'\n    'borderNoise': 1\n    'borderSize': 1\n    'borderThickness': 1\n    'decorations': {\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n    }\n  },\n  'glacier': {\n    'terrainName': 'Glacier'\n    'type': 'glacier'\n    'floors': 'glacier_floor'\n    'borders': 'glacier_walls'\n    'borderNoise': 0\n    'borderSize': 4\n    'borderThickness': 1\n    'decorations': {\n      'hero': {\n        'num': [1, 1]\n        'width': 2\n        'height': 2\n        'clusters': {\n          'hero': [1, 1]\n        }\n      }\n      'Room': {\n        'num': [1,1]\n        'width': [12, 20]\n        'height': [8, 16]\n        'thickness': [2,2]\n        'cluster': 'glacier_walls'\n      }\n    }\n  }\n}\n\npresetSizes = {\n  'small': {\n    'x':80\n    'y':68\n    'sizeFactor':1\n  }\n  'large': {\n    'x':160\n    'y':136\n    'sizeFactor':2\n  }\n}\n\nthangSizes = {\n  'floorSize': {\n    'x':20\n    'y':17\n  }\n  'borderSize': {\n    'x':4\n    'y':4\n  }}\n\n\nmodule.exports = class GenerateTerrainModal extends ModalView\n  id: 'generate-terrain-modal'\n  template: template\n  plain: true\n  modalWidthPercent: 90\n\n  events:\n    'click .choose-option': 'onGenerate'\n\n  constructor: (options) ->\n    super options\n    @presets = presets\n    @presetSizes = presetSizes\n\n  onRevertModel: (e) ->\n    id = $(e.target).val()\n    CocoModel.backedUp[id].revert()\n    $(e.target).closest('tr').remove()\n    @reloadOnClose = true\n\n  onGenerate: (e) ->\n    target = $(e.target)\n    presetType = target.attr 'data-preset-type'\n    presetSize = target.attr 'data-preset-size'\n    @generateThangs presetType, presetSize\n    Backbone.Mediator.publish 'editor:random-terrain-generated', thangs: @thangs, terrain: presets[presetType].terrainName\n    @hide()\n\n  generateThangs: (presetName, presetSize) ->\n    @falseCount = 0\n    preset = presets[presetName]\n    presetSize = presetSizes[presetSize]\n    @thangs = []\n    @rects = []\n    @generateFloor preset, presetSize\n    @generateBorder preset, presetSize, preset.borderNoise\n    @generateDecorations preset, presetSize\n\n  generateFloor: (preset, presetSize) ->\n    for i in _.range(0, presetSize.x, thangSizes.floorSize.x)\n      for j in _.range(0, presetSize.y, thangSizes.floorSize.y)\n        @thangs.push {\n          'id': @getRandomThang(clusters[preset.floors].thangs)\n          'pos': {\n            'x': i + thangSizes.floorSize.x/2\n            'y': j + thangSizes.floorSize.y/2\n          }\n          'margin': clusters[preset.floors].margin\n        }\n\n  generateBorder: (preset, presetSize, noiseFactor=1) ->\n    for i in _.range(0, presetSize.x, thangSizes.borderSize.x)\n      for j in _.range(preset.borderThickness)\n        # Bottom wall\n        while not @addThang {\n          'id': @getRandomThang(clusters[preset.borders].thangs)\n          'pos': {\n            'x': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x/2)\n            'y': 0 + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y)\n          }\n          'margin': clusters[preset.borders].margin\n        }\n          continue\n\n        # Top wall\n        while not @addThang {\n          'id': @getRandomThang(clusters[preset.borders].thangs)\n          'pos': {\n            'x': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x/2)\n            'y': presetSize.y - preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y, thangSizes.borderSize.y/2)\n          }\n          'margin': clusters[preset.borders].margin\n        }\n          continue\n\n        # Double wall on top\n        if preset.type is 'dungeon'\n          @addThang {\n            'id': @getRandomThang(clusters[preset.borders].thangs)\n            'pos': {\n              'x': i + preset.borderSize/2\n              'y': presetSize.y - 3 * preset.borderSize/2\n            }\n            'margin': clusters[preset.borders].margin\n          }\n          if ( i / preset.borderSize ) % 2 and i isnt presetSize.x - thangSizes.borderSize.x\n            @addThang {\n              'id': @getRandomThang(clusters['torch'].thangs)\n              'pos': {\n                'x': i + preset.borderSize\n                'y': presetSize.y - preset.borderSize / 2\n              }\n              'margin': clusters['torch'].margin\n            }\n          else if ( i / preset.borderSize ) % 2 is 0 and i and _.random(100) < 30\n            @addThang {\n              'id': @getRandomThang(clusters['chains'].thangs)\n              'pos': {\n                'x': i + preset.borderSize\n                'y': presetSize.y - preset.borderSize / 2\n              }\n              'margin': clusters['chains'].margin\n            }\n\n    for i in _.range(0, presetSize.y, thangSizes.borderSize.y)\n      for j in _.range(preset.borderThickness)\n        # Left wall\n        while not @addThang {\n          'id': @getRandomThang(clusters[preset.borders].thangs)\n          'pos': {\n            'x': 0 + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x)\n            'y': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y/2)\n          }\n          'margin': clusters[preset.borders].margin\n        }\n          continue\n\n        # Right wall\n        while not @addThang {\n          'id': @getRandomThang(clusters[preset.borders].thangs)\n          'pos': {\n            'x': presetSize.x - preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x, thangSizes.borderSize.x/2)\n            'y': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y/2)\n          }\n          'margin': clusters[preset.borders].margin\n        }\n          continue\n\n  generateDecorations: (preset, presetSize)->\n    for name, decoration of preset.decorations\n      for num in _.range(presetSize.sizeFactor * _.random(decoration.num[0], decoration.num[1]))\n        if @['build'+name] isnt undefined\n          @['build'+name](preset, presetSize, decoration)\n          continue\n        while true\n          rect = {\n            'x':_.random(decoration.width/2 + preset.borderSize/2 + thangSizes.borderSize.x, presetSize.x - decoration.width/2 - preset.borderSize/2 - thangSizes.borderSize.x),\n            'y':_.random(decoration.height/2 + preset.borderSize/2 + thangSizes.borderSize.y, presetSize.y - decoration.height/2 - preset.borderSize/2 - thangSizes.borderSize.y)\n            'width':decoration.width\n            'height':decoration.height\n          }\n          break if @addRect rect\n\n        for cluster, range of decoration.clusters\n          for i in _.range(_.random(range[0], range[1]))\n            while not @addThang {\n              'id':@getRandomThang(clusters[cluster].thangs)\n              'pos':{\n                'x':_.random(rect.x - rect.width/2, rect.x + rect.width/2)\n                'y':_.random(rect.y - rect.height/2, rect.y + rect.height/2)\n              }\n              'margin':clusters[cluster].margin\n            }\n              continue\n\n  buildRoom: (preset, presetSize, room) ->\n    grid = preset.borderSize\n    while true\n      rect = {\n        'width':presetSize.sizeFactor * (room.width[0] + grid * _.random(0, (room.width[1] - room.width[0])/grid))\n        'height':presetSize.sizeFactor * (room.height[0] + grid * _.random(0, (room.height[1] - room.height[0])/grid))\n      }\n      # This logic isn't quite right--it makes the rooms bigger than intended--but it's snapping correctly, which is fine for now.\n      rect.width = Math.round((rect.width - grid) / (2 * grid)) * 2 * grid + grid\n      rect.height = Math.round((rect.height - grid) / (2 * grid)) * 2 * grid + grid\n      roomThickness = _.random(room.thickness[0], room.thickness[1])\n      rect.x = _.random(rect.width/2 + grid * (roomThickness+1.5), presetSize.x - rect.width/2 - grid * (roomThickness+1.5))\n      rect.y = _.random(rect.height/2 + grid * (roomThickness+2.5), presetSize.y - rect.height/2 - grid * (roomThickness+3.5))\n      # Snap room walls to the wall grid.\n      rect.x = Math.round((rect.x - grid / 2) / grid) * grid\n      rect.y = Math.round((rect.y - grid / 2) / grid) * grid\n      break if @addRect {\n        'x': rect.x\n        'y': rect.y\n        'width': rect.width + 2.5 * roomThickness * grid\n        'height': rect.height + 2.5 * roomThickness * grid\n      }\n\n    xRange = _.range(rect.x - rect.width/2 + grid, rect.x + rect.width/2, grid)\n    topDoor = _.random(1) > 0.5\n    topDoorX = xRange[_.random(0, xRange.length-1)]\n    bottomDoor = if not topDoor then true else _.random(1) > 0.5\n    bottomDoorX = xRange[_.random(0, xRange.length-1)]\n\n    for t in _.range(0, roomThickness+1)\n      for i in _.range(rect.x - rect.width/2 - (t-1) * grid, rect.x + rect.width/2 + t * grid, grid)\n        # Bottom wall\n        thang = {\n          'id': @getRandomThang(clusters[room.cluster].thangs)\n          'pos': {\n            'x': i\n            'y': rect.y - rect.height/2 - t * grid\n          }\n          'margin': clusters[room.cluster].margin\n        }\n        if i is bottomDoorX and bottomDoor\n          thang.id = @getRandomThang(clusters['doors'].thangs)\n          thang.pos.y -= grid/3\n        @addThang thang unless i is bottomDoorX and t isnt roomThickness and bottomDoor\n\n        if t is roomThickness and i isnt rect.x - rect.width/2 - (t-1) * grid and preset.type is 'dungeon'\n          if ( i isnt bottomDoorX and i isnt bottomDoorX + grid ) or not bottomDoor\n            @addThang {\n              'id': @getRandomThang(clusters['torch'].thangs)\n              'pos': {\n                'x': thang.pos.x - grid / 2\n                'y': thang.pos.y + grid\n              }\n              'margin': clusters['torch'].margin\n            }\n\n        # Top wall\n        thang = {\n          'id': @getRandomThang(clusters[room.cluster].thangs)\n          'pos': {\n            'x': i\n            'y': rect.y + rect.height/2 + t * grid\n          }\n          'margin': clusters[room.cluster].margin\n        }\n        if i is topDoorX and topDoor\n          thang.id = @getRandomThang(clusters['doors'].thangs)\n          thang.pos.y -= grid\n        @addThang thang unless i is topDoorX and t isnt roomThickness and topDoor\n\n    for t in _.range(0, roomThickness)\n      for i in _.range(rect.y - rect.height/2 - t * grid, rect.y + rect.height/2 + (t+1) * grid, grid)\n        # Left wall\n        @addThang {\n          'id': @getRandomThang(clusters[room.cluster].thangs)\n          'pos': {\n            'x': rect.x - rect.width/2 - t * grid\n            'y': i\n          }\n          'margin': clusters[room.cluster].margin\n        }\n\n        # Right wall\n        @addThang {\n          'id': @getRandomThang(clusters[room.cluster].thangs)\n          'pos': {\n            'x': rect.x + rect.width/2 + t * grid\n            'y': i\n          }\n          'margin': clusters[room.cluster].margin\n        }\n\n  buildBarrels: (preset, presetSize, decoration) ->\n    rect = {\n      'width':presetSize.sizeFactor * ( _.random( decoration.width[0], decoration.width[1] ) )\n      'height':presetSize.sizeFactor * ( _.random( decoration.height[0], decoration.height[1] ) )\n    }\n    x = [ rect.width/2 + preset.borderSize , presetSize.x - rect.width/2 - preset.borderSize ]\n    y = [ rect.height/2 + preset.borderSize , presetSize.y - rect.height/2 - 2 * preset.borderSize ]\n\n    for i in x\n      for j in y\n        if _.random(100) < 40\n          rect = {\n            'x': i\n            'y': j\n            'width': rect.width\n            'height': rect.height\n          }\n          if @addRect rect\n            for num in _.range( _.random( decoration.numBarrels[0], decoration.numBarrels[1] ) )\n              while not @addThang {\n                'id': @getRandomThang(clusters[decoration.cluster].thangs)\n                'pos': {\n                  'x': _.random(rect.x - rect.width/2, rect.x + rect.width/2)\n                  'y': _.random(rect.y - rect.height/2, rect.y + rect.height/2)\n                }\n                'margin': clusters[decoration.cluster].margin\n              }\n                continue\n\n  addThang: (thang) ->\n    if @falseCount > 100\n      console.log 'infinite loop', thang\n      @falseCount = 0\n      return true\n    for existingThang in @thangs\n      if existingThang.margin is -1 or thang.margin is -1\n        continue\n      if Math.abs(existingThang.pos.x - thang.pos.x) < thang.margin + existingThang.margin and Math.abs(existingThang.pos.y - thang.pos.y) < thang.margin + existingThang.margin\n        @falseCount++\n        return false\n    @thangs.push thang\n    true\n\n  addRect: (rect) ->\n    if @falseCount > 100\n      console.log 'infinite loop', rect\n      @falseCount = 0\n      return true\n    for existingRect in @rects\n      if Math.abs(existingRect.x - rect.x) <= rect.width/2 + existingRect.width/2 and Math.abs(existingRect.y - rect.y) <= rect.height/2 + existingRect.height/2\n        @falseCount++\n        return false\n    @rects.push rect\n    true\n\n  getRandomThang: (thangList) ->\n    return thangList[_.random(0, thangList.length-1)]\n\n  onHidden: ->\n    location.reload() if @reloadOnClose\n"]}