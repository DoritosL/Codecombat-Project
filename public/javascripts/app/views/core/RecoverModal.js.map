{"version":3,"sources":["app/templates/core/recover-modal.jade","app/views/core/RecoverModal.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;;ACAA;EAAA;;;;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,WAAW,QAAQ,8BAAR;;AACX,QAAQ,QAAQ,YAAR;;AACP,iBAAkB,QAAQ,aAAR,EAAlB;;AAED,uBAAuB,SAAC,aAAD,EAAgB,IAAhB;AACrB,SAAO;AACL;IADM;IACN,IAAI,KAAM;IACV,MAAc,QAAC,CAAC,OAAF,eAAa,aAAb,gBAA8B,CAAI,CAAC,CAAC,OAAlD;AAAA;;AACA,WAAO,iBAAK,KAAL;EAHF;AADc;;AAMvB,MAAM,CAAC,OAAP,GAAuB;;;yBACrB,KAAI;;yBACJ,WAAU;;yBAEV,SACE;IAAA,yBAAyB,gBAAzB;IACA,iBAAiB,gBADjB;;;yBAGF,gBACE;IAAA,uBAAuB,eAAvB;;;yBAEF,gBAAe,SAAC,CAAD;WACb,IAAC,uBAAD,CAAwB,IAAC,IAAzB;EADa;;EAGF,sBAAC,OAAD;;;IACX,IAAC,eAAD,GAAkB,qBAAqB,CAAC,EAAD,CAArB,EAA2B,IAAC,eAA5B;IAClB,8CAAM,OAAN;EAFW;;yBAIb,iBAAgB,SAAC,CAAD;AACd;IAAA,IAAC,UAAD,CAAW,mBAAX;IACA,KAAK,CAAC,eAAN,CAAsB,IAAC,IAAvB;IACA,QAAQ,CAAC,KAAK,CAAC,YAAN,CAAmB,IAAC,IAApB,CAAD,CAAyB,CAAC;IAClC,KAAc,KAAd;AAAA;;IACA,MAAM,CAAC,CAAC,IAAF,CAAO,aAAP,EAAsB;MAAC,OAAO,KAAR;KAAtB,EAAsC,IAAC,sBAAvC;IACN,GAAG,CAAC,IAAJ,CAAS,cAAT;WACA,IAAC,sBAAD,CAAuB,IAAC,IAAxB;EAPc;;yBAShB,wBAAuB;IACrB,IAAC,uBAAD,CAAwB,IAAC,IAAzB;IACA,IAAC,IAAG,CAAC,IAAL,CAAU,qBAAV,CAAgC,CAAC,IAAjC,CAAsC,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,uBAAT,CAAtC;WACA,IAAC,IAAG,CAAC,IAAL,CAAU,eAAV,CAA0B,CAAC,MAA3B;EAHqB;;;;GA3BmB","file":"public/javascripts/app/views/core/RecoverModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"recover.recover_account_title\\\">Recover Account</h3></div><div class=\\\"modal-body\\\"><div class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"recover-email\\\" data-i18n=\\\"general.email\\\" class=\\\"control-label\\\">Email     </label><input id=\\\"recover-email\\\" name=\\\"email\\\" type=\\\"email\\\" class=\\\"input-large form-control\\\"/></div></div></div><div class=\\\"modal-body wait secret\\\"><h3 data-i18n=\\\"common.sending\\\">Sending...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button id=\\\"recover-button\\\" data-i18n=\\\"recover.send_password\\\" class=\\\"btn btn-primary btn-large\\\">Send Recovery Password</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\ntemplate = require 'templates/core/recover-modal'\nforms = require 'core/forms'\n{genericFailure} = require 'core/errors'\n\nfilterKeyboardEvents = (allowedEvents, func) ->\n  return (splat...) ->\n    e = splat[0]\n    return unless e.keyCode in allowedEvents or not e.keyCode\n    return func(splat...)\n\nmodule.exports = class RecoverModal extends ModalView\n  id: 'recover-modal'\n  template: template\n\n  events:\n    'click #recover-button': 'recoverAccount'\n    'keydown input': 'recoverAccount'\n\n  subscriptions:\n    'errors:server-error': 'onServerError'\n\n  onServerError: (e) -> # TODO: work error handling into a separate forms system\n    @disableModalInProgress(@$el)\n\n  constructor: (options) ->\n    @recoverAccount = filterKeyboardEvents([13], @recoverAccount) # TODO: part of forms\n    super options\n\n  recoverAccount: (e) =>\n    @playSound 'menu-button-click'\n    forms.clearFormAlerts(@$el)\n    email = (forms.formToObject @$el).email\n    return unless email\n    res = $.post '/auth/reset', {email: email}, @successfullyRecovered\n    res.fail(genericFailure)\n    @enableModalInProgress(@$el)\n\n  successfullyRecovered: =>\n    @disableModalInProgress(@$el)\n    @$el.find('.modal-body:visible').text($.i18n.t('recover.recovery_sent'))\n    @$el.find('.modal-footer').remove()\n"]}