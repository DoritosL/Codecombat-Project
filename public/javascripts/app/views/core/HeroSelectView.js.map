{"version":3,"sources":["app/templates/core/hero-select-view.jade","app/views/core/HeroSelectView.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/DA;AAAA;;ACAA;EAAA;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,iCAAR;;AACX,YAAY,QAAQ,kBAAR;;AACZ,aAAa,QAAQ,wBAAR;;AACb,QAAQ,QAAQ,cAAR;;AACR,YAAY,QAAQ,kBAAR;;AACZ,OAAO,QAAQ,aAAR;;AAEP,MAAM,CAAC,OAAP,GAAuB;;;;;;;2BACrB,KAAI;;2BACJ,WAAU;;2BAEV,SACE;IAAA,sBAAsB,mBAAtB;;;2BAEF,aAAY,SAAC,OAAD;AACV;IADW,IAAC,6BAAD,UAAW;IACtB,sBAAsB,SAAS,CAAC,MAAM,CAAC;IACvC,iEAA0C,CAAE,mBAAtB,IAAmC;IAEzD,IAAC,gBAAD,GAAmB,CAAC,CAAC,QAAF,CAAW,IAAC,OAAZ,EAAoB,CAApB;IAEnB,IAAC,MAAD,GAAa,UAAM;MACjB,wCADiB;MAEjB,sBAAsB,mBAFL;KAAN;IAKb,IAAC,OAAD,GAAc,eAAW,EAAX,EAAe;MAAE,SAAS,CAAC,UAAD,EAAa,MAAb,EAAqB,WAArB,CAAX;KAAf;IACd,IAAC,WAAU,CAAC,YAAZ,CAAyB,IAAC,OAAM,CAAC,WAAR,EAAzB;IAEA,IAAC,SAAD,CAAU,IAAC,MAAX,EAAkB,KAAlB,EAAyB;aAAG,IAAC,gBAAD;IAAH,CAAzB;WACA,IAAC,SAAD,CAAU,IAAC,OAAX,EAAmB,KAAnB,EAA0B;aAAG,IAAC,gBAAD;IAAH,CAA1B;EAfU;;2BAiBZ,oBAAmB,SAAC,CAAD;AACjB;IAAA,eAAe,EAAE,CAAC,CAAC,aAAJ,CAAkB,CAAC,IAAnB,CAAwB,eAAxB;IACf,IAAC,MAAK,CAAC,GAAP,CAAW;MAAA,sBAAsB,YAAtB;KAAX;WACA,IAAC,kBAAD,CAAmB,YAAnB;EAHiB;;2BAKnB,oBAAmB,SAAC,YAAD;AACjB;IAAA,KAA8B,EAAE,CAAC,GAAH,CAAO,YAAP,CAA9B;MAAA,EAAE,CAAC,GAAH,CAAO;QAAA,YAAY,EAAZ;OAAP;;IACA,aAAa,CAAC,CAAC,MAAF,CAAS,EAAE,CAAC,GAAH,CAAO,YAAP,CAAT,EAA+B;MAAE,WAAW,YAAb;KAA/B;IACb,EAAE,CAAC,GAAH,CAAO;MAAE,sBAAF;KAAP;IAEA,OAAO,IAAC,OAAM,CAAC,SAAR,CAAkB;MAAE,UAAU,YAAZ;KAAlB;WACP,EAAE,CAAC,IAAH,EAAS,CAAC,IAAV,CAAe;aAAA;AACb;QAAA,QAAQ;QACR,SAAY,EAAE,CAAC,SAAH,EAAH,GAAuB,UAAvB,GAAuC;QAChD,IAA8B,KAAC,QAAO,CAAC,aAAvC;UAAA,SAAS,kBAAT;;QACA,WAAc,EAAE,CAAC,SAAH,EAAH,GAAuB,UAAvB,GAAuC;;aACpC,CAAE,UAAhB,CAA2B,KAA3B,EAAkC;YAAC,kBAAD;YAAW,0BAAX;WAAlC,EAA4D,EAA5D;;eACA,KAAC,QAAD,CAAS,qBAAT,EAAgC,IAAhC;MANa;IAAA,QAAf;EANiB;;;;GA7ByB","file":"public/javascripts/app/views/core/HeroSelectView.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),state = locals_.state,view = locals_.view;var heroOption_mixin = function(hero){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nvar heroOriginal = hero.get('original')\nvar selectedState\nif ( state.get('selectedHeroOriginal') === heroOriginal)\n{\nselectedState = 'selected'\n}\nelse if ( view.options.showCurrentHero && state.get('currentHeroOriginal') === heroOriginal)\n{\nselectedState = 'current'\n}\nelse\n{\nselectedState = ''\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-hero-original':(heroOriginal), \"class\": [('hero-option'),(selectedState)] }, {\"class\":true,\"data-hero-original\":true})) + \"><div class=\\\"hero-avatar\\\"><img\" + (jade.attrs({ 'src':(hero.getPortraitURL()) }, {\"src\":true})) + \"/></div><div class=\\\"text-h5 hero-name\\\"><span>\" + (jade.escape(null == (jade.interp = hero.getHeroShortName()) ? \"\" : jade.interp)) + \"</span></div></div>\");\n};\nbuf.push(\"<div class=\\\"hero-list\\\">\");\nif ( view.heroes.loaded)\n{\n// iterate view.heroes.models\n;(function(){\n  var $$obj = view.heroes.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var hero = $$obj[$index];\n\nif ( hero.get('heroClass') === 'Warrior')\n{\nheroOption_mixin(hero);\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var hero = $$obj[$index];\n\nif ( hero.get('heroClass') === 'Warrior')\n{\nheroOption_mixin(hero);\n}\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","CocoView = require 'views/core/CocoView'\ntemplate = require 'templates/core/hero-select-view'\nClassroom = require 'models/Classroom'\nThangTypes = require 'collections/ThangTypes'\nState = require 'models/State'\nThangType = require 'models/ThangType'\nUser = require 'models/User'\n\nmodule.exports = class HeroSelectView extends CocoView\n  id: 'hero-select-view'\n  template: template\n\n  events:\n    'click .hero-option': 'onClickHeroOption'\n\n  initialize: (@options = {}) ->\n    defaultHeroOriginal = ThangType.heroes.captain\n    currentHeroOriginal = me.get('heroConfig')?.thangType or defaultHeroOriginal\n\n    @debouncedRender = _.debounce @render, 0\n\n    @state = new State({\n      currentHeroOriginal\n      selectedHeroOriginal: currentHeroOriginal\n    })\n\n    @heroes = new ThangTypes({}, { project: ['original', 'name', 'heroClass'] })\n    @supermodel.trackRequest @heroes.fetchHeroes()\n\n    @listenTo @state, 'all', -> @debouncedRender()\n    @listenTo @heroes, 'all', -> @debouncedRender()\n\n  onClickHeroOption: (e) ->\n    heroOriginal = $(e.currentTarget).data('hero-original')\n    @state.set selectedHeroOriginal: heroOriginal\n    @saveHeroSelection(heroOriginal)\n\n  saveHeroSelection: (heroOriginal) ->\n    me.set(heroConfig: {}) unless me.get('heroConfig')\n    heroConfig = _.assign me.get('heroConfig'), { thangType: heroOriginal }\n    me.set({ heroConfig })\n\n    hero = @heroes.findWhere({ original: heroOriginal })\n    me.save().then =>\n      event = 'Hero selected'\n      event += if me.isStudent() then ' student' else ' teacher'\n      event += ' create account' if @options.createAccount\n      category = if me.isStudent() then 'Students' else 'Teachers'\n      window.tracker?.trackEvent event, {category, heroOriginal}, []\n      @trigger 'hero-select:success', hero\n"]}